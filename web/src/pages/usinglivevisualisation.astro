---
import Layout from "../layouts/Layout.astro";
import "../styles/mimic.css";
---

<Layout title="Visual Git - UI Guide">
  <section class="color:c1text2 background-color:c1background1">

    <!-- Hero -->
    <div class="text-align:center padding:xl padding-top:2xl">
      <h1 class="titleFont font-size:xl lg?font-size:xl margin-bottom:lg">Visual Git Desktop UI</h1>
      <p class="font-size:lg max-width:60ch margin-left:auto margin-right:auto">
        An interactive visualization of your Git repository internals. Explore commits, branches, trees, blobs and more on a live canvas.
      </p>
    </div>

    <!-- Color legend -->
    <div class="fade-in-on-scroll display:flex flex-wrap:wrap justify-content:center gap:lg padding:xl padding-bottom:xl">
      <div class="display:flex align-items:center gap:sm"><span class="node-dot node-commit"></span> Commits</div>
      <div class="display:flex align-items:center gap:sm"><span class="node-dot node-tree"></span> Trees</div>
      <div class="display:flex align-items:center gap:sm"><span class="node-dot node-blob"></span> Blobs</div>
      <div class="display:flex align-items:center gap:sm"><span class="node-dot node-branch"></span> Branches</div>
      <div class="display:flex align-items:center gap:sm"><span class="node-dot node-tag"></span> Tags</div>
      <div class="display:flex align-items:center gap:sm"><span class="node-dot node-head"></span> HEAD</div>
    </div>

    <!-- 1. Interactive Git Graph -->
    <div class="fade-in-on-scroll display:flex flex-direction:column lg?flex-direction:row align-items:center padding:xl gap:xl">
      <div class="screenshot-placeholder lg?flex-basis:50%">
        <!-- TODO: Add screenshot of full git graph canvas -->
        <span>Git Graph Canvas</span>
      </div>
      <div class="lg?flex-basis:50% max-width:50ch">
        <h2 class="titleFont font-size:lg margin-bottom:md">Interactive Git Graph</h2>
        <p class="line-height:1.6 margin-bottom:md">
          The main canvas displays every object in your repository as a color-coded node with directional links showing relationships between commits, trees, blobs, branches and tags.
        </p>
        <p class="line-height:1.6">
          Labels on each node show the hash, commit message, branch name or filename so you always know what you're looking at.
        </p>
      </div>
    </div>

    <!-- 2. Toggle Visibility -->
    <div class="slide-in-right-on-scroll display:flex flex-direction:column-reverse lg?flex-direction:row align-items:center padding:xl gap:xl background-color:c1background2">
      <div class="lg?flex-basis:50% max-width:50ch">
        <h2 class="titleFont font-size:lg margin-bottom:md">Toggle Visibility</h2>
        <p class="line-height:1.6 margin-bottom:md">
          Use the checkboxes at the bottom of the screen to show or hide Trees, Blobs and Tags. Hiding trees and blobs reduces clutter so you can focus on the commit history and branch structure.
        </p>
        <p class="line-height:1.6">
          When nodes are hidden, links automatically re-route so the graph stays connected and readable.
        </p>
      </div>
      <div class="lg?flex-basis:50% display:flex flex-direction:column align-items:center gap:md">
        <div class="screenshot-placeholder">
          <!-- TODO: Add screenshot of toggle checkboxes -->
          <span>Toggle Controls</span>
        </div>
        <!-- CSS-only toggle demo -->
        <div class="toggle-demo">
          <div class="toggle-demo-nodes">
            <span class="node-dot node-commit"></span>
            <span class="node-dot node-tree toggle-target"></span>
            <span class="node-dot node-blob toggle-target"></span>
            <span class="node-dot node-branch"></span>
          </div>
          <label class="toggle-label">
            <input type="checkbox" checked class="toggle-checkbox" />
            Show Trees &amp; Blobs
          </label>
        </div>
      </div>
    </div>

    <!-- 3. Drag & Reposition -->
    <div class="fade-in-on-scroll display:flex flex-direction:column lg?flex-direction:row align-items:center padding:xl gap:xl">
      <div class="lg?flex-basis:50% display:flex justify-content:center">
        <div class="drag-demo-container">
          <span class="drag-dot node-commit"></span>
          <span class="drag-hint">drag me</span>
        </div>
      </div>
      <div class="lg?flex-basis:50% max-width:50ch">
        <h2 class="titleFont font-size:lg margin-bottom:md">Drag &amp; Reposition Nodes</h2>
        <p class="line-height:1.6 margin-bottom:md">
          Click and drag any node to reposition it on the canvas. Arrange the graph in whatever layout makes most sense to you.
        </p>
        <p class="line-height:1.6">
          Your custom positions are preserved proportionally when the window is resized or the repository refreshes, so your layout is never lost.
        </p>
      </div>
    </div>

    <!-- 4. Working & Staging Panels -->
    <div class="slide-in-left-on-scroll display:flex flex-direction:column-reverse lg?flex-direction:row align-items:center padding:xl gap:xl background-color:c1background2">
      <div class="lg?flex-basis:50% max-width:50ch">
        <h2 class="titleFont font-size:lg margin-bottom:md">Working &amp; Staging Area Panels</h2>
        <p class="line-height:1.6 margin-bottom:md">
          Two draggable panels in the lower-left show the files in your working directory and staging area. Each panel has an indigo header bar you can grab to reposition it.
        </p>
        <p class="line-height:1.6 margin-bottom:md">
          Click the chevron to collapse or expand a panel. File entries show the filename, a short hash and a preview of the file contents.
        </p>
      </div>
      <div class="lg?flex-basis:50% display:flex flex-direction:column align-items:center gap:md">
        <!-- Panel demo -->
        <div class="panel-demo">
          <div class="panel-header">Working Area <span class="chevron">&#9650;</span></div>
          <div class="panel-body">
            <div class="panel-file">file1.txt <span class="panel-hash">a1b2</span></div>
            <div class="panel-file">file2.txt <span class="panel-hash">c3d4</span></div>
          </div>
        </div>
        <div class="panel-demo">
          <div class="panel-header">Staging Area <span class="chevron">&#9650;</span></div>
          <div class="panel-body">
            <div class="panel-file">file1.txt <span class="panel-hash">a1b2</span></div>
          </div>
        </div>
      </div>
    </div>

    <!-- 5. Real-time Updates -->
    <div class="fade-in-on-scroll display:flex flex-direction:column lg?flex-direction:row align-items:center padding:xl gap:xl">
      <div class="lg?flex-basis:50% display:flex justify-content:center">
        <div class="realtime-demo">
          <span class="realtime-ring"></span>
          <span class="realtime-dot"></span>
          <span class="realtime-label">LIVE</span>
        </div>
      </div>
      <div class="lg?flex-basis:50% max-width:50ch">
        <h2 class="titleFont font-size:lg margin-bottom:md">Real-time Updates</h2>
        <p class="line-height:1.6 margin-bottom:md">
          A file watcher monitors your <code>.git</code> directory and working tree. When you commit, stage, branch or edit a file, the visualization refreshes automatically within moments.
        </p>
        <p class="line-height:1.6">
          No manual refresh needed. Just work in your terminal and watch the graph evolve in real time.
        </p>
      </div>
    </div>

    <!-- 6. Repository Selection -->
    <div class="slide-in-right-on-scroll display:flex flex-direction:column-reverse lg?flex-direction:row align-items:center padding:xl padding-bottom:2xl gap:xl background-color:c1background2">
      <div class="lg?flex-basis:50% max-width:50ch">
        <h2 class="titleFont font-size:lg margin-bottom:md">Repository Selection</h2>
        <p class="line-height:1.6 margin-bottom:md">
          On launch you are greeted with a welcome screen and an "Open Repository" button. Pick any folder containing a <code>.git</code> directory to start visualizing.
        </p>
        <p class="line-height:1.6">
          Switch repositories at any time using the "Change Repo" button in the bottom info bar, which also displays the current repo path.
        </p>
      </div>
      <div class="screenshot-placeholder lg?flex-basis:50%">
        <!-- TODO: Add screenshot of welcome / repo selection screen -->
        <span>Repo Selection Screen</span>
      </div>
    </div>

  </section>
</Layout>

<style>
  /* Node color dots */
  .node-dot {
    display: inline-block;
    width: 18px;
    height: 18px;
    border-radius: 50%;
    flex-shrink: 0;
  }
  .node-commit { background: #e94560; }
  .node-tree { background: #4ade80; }
  .node-blob { background: #60a5fa; }
  .node-branch { background: #a855f7; }
  .node-tag { background: #fb923c; }
  .node-head { background: #facc15; }

  /* Screenshot placeholders */
  .screenshot-placeholder {
    width: 100%;
    max-width: 480px;
    aspect-ratio: 16 / 10;
    background: #1e293b;
    border: 2px dashed #475569;
    border-radius: 12px;
    display: flex;
    align-items: center;
    justify-content: center;
    color: #94a3b8;
    font-size: 1.1rem;
  }

  /* Toggle demo */
  .toggle-demo {
    background: #0f172a;
    border-radius: 12px;
    padding: 20px 28px;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 14px;
  }
  .toggle-demo-nodes {
    display: flex;
    gap: 16px;
  }
  .toggle-checkbox {
    margin-right: 6px;
    accent-color: #4ade80;
  }
  .toggle-checkbox:not(:checked) ~ .toggle-target,
  .toggle-demo:has(.toggle-checkbox:not(:checked)) .toggle-target {
    opacity: 0;
    transform: scale(0);
    transition: all 0.3s ease;
  }
  .toggle-target {
    transition: all 0.3s ease;
  }
  .toggle-label {
    color: #cbd5e1;
    cursor: pointer;
    user-select: none;
  }

  /* Drag demo */
  .drag-demo-container {
    position: relative;
    width: 160px;
    height: 80px;
    display: flex;
    align-items: center;
    justify-content: center;
  }
  .drag-dot {
    width: 36px;
    height: 36px;
    border-radius: 50%;
    animation: drag-bounce 2.4s ease-in-out infinite;
    position: absolute;
  }
  .drag-hint {
    position: absolute;
    bottom: 0;
    font-size: 0.85rem;
    color: #94a3b8;
    animation: drag-hint-fade 2.4s ease-in-out infinite;
  }
  @keyframes drag-bounce {
    0%, 100% { transform: translateX(-40px); }
    50% { transform: translateX(40px); }
  }
  @keyframes drag-hint-fade {
    0%, 100% { opacity: 0.4; }
    50% { opacity: 1; }
  }

  /* Panel demo */
  .panel-demo {
    width: 220px;
    border: 1px solid #475569;
    border-radius: 10px;
    overflow: hidden;
    background: #000;
  }
  .panel-header {
    background: #4b0082;
    padding: 6px 12px;
    font-size: 0.85rem;
    display: flex;
    justify-content: space-between;
    cursor: grab;
  }
  .chevron { font-size: 0.7rem; }
  .panel-body { padding: 8px 12px; }
  .panel-file {
    display: flex;
    justify-content: space-between;
    font-size: 0.8rem;
    padding: 3px 0;
    font-family: monospace;
  }
  .panel-hash { color: #94a3b8; }

  /* Real-time pulse demo */
  .realtime-demo {
    position: relative;
    width: 120px;
    height: 120px;
    display: flex;
    align-items: center;
    justify-content: center;
  }
  .realtime-dot {
    width: 16px;
    height: 16px;
    background: #e94560;
    border-radius: 50%;
    z-index: 1;
  }
  .realtime-ring {
    position: absolute;
    width: 16px;
    height: 16px;
    border-radius: 50%;
    border: 2px solid #e94560;
    animation: pulse-ring 1.8s ease-out infinite;
  }
  .realtime-label {
    position: absolute;
    bottom: 10px;
    font-size: 0.75rem;
    font-weight: bold;
    letter-spacing: 2px;
    color: #e94560;
  }
  @keyframes pulse-ring {
    0% { transform: scale(1); opacity: 1; }
    100% { transform: scale(4); opacity: 0; }
  }

  code {
    background: #1e293b;
    padding: 2px 6px;
    border-radius: 4px;
    font-size: 0.9em;
  }
</style>

<script is:inline>
  function initScrollAnimations() {
    const classes = [
      ["fade-in-on-scroll", "fade-in-visible"],
      ["slide-in-right-on-scroll", "slide-in-right-visible"],
      ["slide-in-left-on-scroll", "slide-in-left-visible"],
    ];
    classes.forEach(([trigger, visible]) => {
      const els = document.querySelectorAll("." + trigger);
      const observer = new IntersectionObserver(
        (entries) => {
          entries.forEach((e) => {
            if (e.isIntersecting) e.target.classList.add(visible);
          });
        },
        { threshold: 0.1 }
      );
      els.forEach((el) => observer.observe(el));
    });
  }
  initScrollAnimations();
</script>
